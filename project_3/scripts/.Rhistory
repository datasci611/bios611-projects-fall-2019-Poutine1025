Client$Gender=ifelse(Client$Gender=="Trans Female (MTF or Male to Female)","TransFemale",Client$Gender)
Client$Race=ifelse(Client$Race=="White (HUD)","White",Client$Race)
Client$Race=ifelse(Client$Race=="Asian (HUD)","Asian",Client$Race)
Client$Race=ifelse(Client$Race=="Black or African American (HUD)","AfricanAmerican",Client$Race)
unique(Client$Race)
Client$Race=ifelse(Client$Race=="American Indian or Alaska Native (HUD)","AmericanIndian",Client$Race)
unique(Client$Race)
Client$Race=ifelse(Client$Race=="Native Hawaiian or Other Pacific Islander (HUD)","NativeHawaiian",Client$Race)
unique(Client$Race)
unique(Client$Ethnicity)
Client$Ethnicity=ifelse(Client$Ethnicity=="Hispanic/Latino (HUD)","Latino","Non-Latino")
unique(Client$Ethnicity)
ggplot(data = Client, aes(x=Gender, y=age)) +
geom_boxplot()
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot()
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender))
Client=read_csv("Client.csv")
#Demographics
Client$Gender=ifelse(Client$Gender=="Trans Female (MTF or Male to Female)","TransF",Client$Gender)
Client$Race=ifelse(Client$Race=="White (HUD)","White",Client$Race)
Client$Race=ifelse(Client$Race=="Asian (HUD)","Asian",Client$Race)
Client$Race=ifelse(Client$Race=="Black or African American (HUD)","African",Client$Race)
Client$Race=ifelse(Client$Race=="American Indian or Alaska Native (HUD)","Indian",Client$Race)
Client$Race=ifelse(Client$Race=="Native Hawaiian or Other Pacific Islander (HUD)","Hawaiian",Client$Race)
Client$Ethnicity=ifelse(Client$Ethnicity=="Hispanic/Latino (HUD)","Latino","Non-Latino")
#Age vs Gender
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot()
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender))
#Ethinity
ggplot(data = Client, aes(x=Ethnicity)) +
geom_bar(aes(fill=Gender))
summary(logistic_model)
#Age
ggplot(data = Client, aes(x=Age)) +
geom_histogram()
#Age
ggplot(data = Client, aes(x=Age)) +
geom_histogram() +
theme_light()
#Age vs Gender
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot()
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender))
#Ethinity
ggplot(data = Client, aes(x=Ethnicity)) +
geom_bar(aes(fill=Gender))
View(Disability)
#Income
ggplot(data = Income, aes(x=Income)) +
geom_histogram() +
theme_light()
summary(invgaussain_model)
logistic_model=glm(Disability~Gender+Race+Ethnicity+Age,
data = Disability,
family = binomial(link = "logit"))
summary(logistic_model)
#inverse gaussian regression
ggplot(data = Client, aes(x=Gender, y=Income)) +
geom_boxplot()
#inverse gaussian regression
ggplot(data = Income, aes(x=Gender, y=Income)) +
geom_boxplot()
summary(invgaussain_model)
plot(sort(logistic_model$fitted.values))
plot(sort(logistic_model$fitted.values)ï¼Œtype="l")
plot(sort(logistic_model$fitted.values), type="l")
plot(sort(invgaussain_model$fitted.values))
plot(sort(invgaussain_model$fitted.values),type="l")
#Age
ggplot(data = Client, aes(x=Age)) +
geom_histogram() +
theme_light()
#Age vs Gender
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot()
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender))
#Ethinity
ggplot(data = Client, aes(x=Ethnicity)) +
geom_bar(aes(fill=Gender))
#Disability
#logistic regression
Disability$Disability=ifelse(Disability$Disability=="Yes (HUD)",1,0)
logistic_model=glm(Disability~Gender+Race+Ethnicity+Age,
data = Disability,
family = binomial(link = "logit"))
Disability=read_csv("Disability.csv")
#Disability
#logistic regression
Disability$Disability=ifelse(Disability$Disability=="Yes (HUD)",1,0)
logistic_model=glm(Disability~Gender+Race+Ethnicity+Age,
data = Disability,
family = binomial(link = "logit"))
summary(logistic_model)
#Income
ggplot(data = Income, aes(x=Income)) +
geom_histogram() +
theme_light()
#inverse gaussian regression
ggplot(data = Income, aes(x=Gender, y=Income)) +
geom_boxplot()
invgaussain_model=glm(Income~Gender+Race+Ethnicity+Age,
data = Income,
family = inverse.gaussian(link = "1/mu^2"))
summary(invgaussain_model)
Income = Income %>%
mutate(fittedval=invgaussain_model$fitted.values)
View(Client)
View(Client)
range(Client$Age)
library(tidyverse)
Income=read_csv("Income.csv")
getwd()
setwd("/Users/jianchen/Documents/GitHub/bios611-projects-fall-2019-Poutine1025/project_3/scripts/")
Income=read_csv("Income.csv")
library(tidyverse)
Income=read_csv("Income.csv")
library(tidyverse)
Disability=read_csv("Disability.csv")
library(tidyverse)
setwd("/Users/jianchen/Documents/GitHub/bios611-projects-fall-2019-Poutine1025/project_3/scripts/")
Income=read_csv("Income.csv")
Disability=read_csv("Disability.csv")
Client=read_csv("Client.csv")
library(tidyverse)
setwd("/Users/jianchen/Documents/GitHub/bios611-projects-fall-2019-Poutine1025/project_3/scripts/")
Income=read_csv("Income.csv")
Disability=read_csv("Disability.csv")
Client=read_csv("Client.csv")
Client$Gender=ifelse(Client$Gender=="Trans Female (MTF or Male to Female)","TransF",Client$Gender)
Client$Race=ifelse(Client$Race=="White (HUD)","White",Client$Race)
Client$Race=ifelse(Client$Race=="Asian (HUD)","Asian",Client$Race)
Client$Race=ifelse(Client$Race=="Black or African American (HUD)","African",Client$Race)
Client$Race=ifelse(Client$Race=="American Indian or Alaska Native (HUD)","Indian",Client$Race)
Client$Race=ifelse(Client$Race=="Native Hawaiian or Other Pacific Islander (HUD)","Hawaiian",Client$Race)
Client$Ethnicity=ifelse(Client$Ethnicity=="Hispanic/Latino (HUD)","Latino","Non-Latino")
View(Client)
#Age
ggplot(data = Client, aes(x=Age)) +
geom_histogram() +
theme_light()
#Age vs Gender
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot()
#Age vs Gender
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race))
#Age
ggplot(data = Client, aes(x=Age)) +
geom_histogram() +
theme_light()
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender))
#Age vs Gender
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race))
#Age
ggplot(data = Client, aes(x=Age)) +
geom_histogram() +
theme_light()
#Age vs Gender
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race))
#Age vs Gender filled by Ethnicity
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Ethinicity))
#Age vs Gender filled by Ethnicity
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Ethnicity))
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender))
#Age vs Gender filled by Race
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race))
#Age vs Gender filled by Ethnicity
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Ethnicity))
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender))
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender))
#Ethinity
ggplot(data = Client, aes(x=Ethnicity)) +
geom_bar(aes(fill=Gender))
#Age vs Gender filled by Race
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race))
#Age vs Gender filled by Ethnicity
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Ethnicity))
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender))
#Ethinity
ggplot(data = Client, aes(x=Ethnicity)) +
geom_bar(aes(fill=Gender))
library(tidyverse)
setwd("/Users/jianchen/Documents/GitHub/bios611-projects-fall-2019-Poutine1025/project_3/scripts/")
# Import data
Income=read_csv("Income.csv")
Disability=read_csv("Disability.csv")
Client=read_csv("Client.csv")
# Redefine the values of variable
Client$Gender=ifelse(Client$Gender=="Trans Female (MTF or Male to Female)","TransF",Client$Gender)
Client$Race=ifelse(Client$Race=="White (HUD)","White",Client$Race)
Client$Race=ifelse(Client$Race=="Asian (HUD)","Asian",Client$Race)
Client$Race=ifelse(Client$Race=="Black or African American (HUD)","African",Client$Race)
Client$Race=ifelse(Client$Race=="American Indian or Alaska Native (HUD)","Indian",Client$Race)
Client$Race=ifelse(Client$Race=="Native Hawaiian or Other Pacific Islander (HUD)","Hawaiian",Client$Race)
Client$Ethnicity=ifelse(Client$Ethnicity=="Hispanic/Latino (HUD)","Latino","Non-Latino")
Disability$Disability=ifelse(Disability$Disability=="Yes (HUD)",1,0)
View(Client)
View(Disability)
#Age vs Gender filled by Race
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race))
#Age vs Gender filled by Race
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race)) +
labs(title="Age vs Gender filled by Race")
#Age vs Gender filled by Ethnicity
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Ethnicity)) +
labs(Age vs Gender filled by Ethnicity)
#Age vs Gender filled by Ethnicity
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Ethnicity)) +
labs(title="Age vs Gender filled by Ethnicity")
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender))
#Ethinity
ggplot(data = Client, aes(x=Ethnicity)) +
geom_bar(aes(fill=Gender))
#Age vs Gender filled by Race
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race)) +
labs(title="Age vs Gender filled by Race")
#Age vs Gender filled by Ethnicity
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Ethnicity)) +
labs(title="Age vs Gender filled by Ethnicity")
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender))
#Ethinity
ggplot(data = Client, aes(x=Ethnicity)) +
geom_bar(aes(fill=Gender))
#Age vs Gender filled by Race
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race)) +
labs(title="Age vs Gender filled by Race") +
theme_dark()
#Age vs Gender filled by Race
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race)) +
labs(title="Age vs Gender filled by Race") +
theme_light()
#Age vs Gender filled by Ethnicity
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Ethnicity)) +
labs(title="Age vs Gender filled by Ethnicity") +
theme_light()
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender))
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender)) +
labs(title = "Sizes of different races")
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender)) +
labs(title = "Sample sizes of different races") +
theme_linedraw()
#Ethinity
ggplot(data = Client, aes(x=Ethnicity)) +
geom_bar(aes(fill=Gender)) +
labs(title = "Sample sizes of different Ethnicities")
#Ethinity
ggplot(data = Client, aes(x=Ethnicity)) +
geom_bar(aes(fill=Gender)) +
labs(title = "Sample sizes of different Ethnicities") +
theme_linedraw()
library(tidyverse)
setwd("/Users/jianchen/Documents/GitHub/bios611-projects-fall-2019-Poutine1025/project_3/scripts/")
# Import data
Income=read_csv("Income.csv")
Disability=read_csv("Disability.csv")
Client=read_csv("Client.csv")
# Redefine the values of variable
Client$Gender=ifelse(Client$Gender=="Trans Female (MTF or Male to Female)","TransF",Client$Gender)
Client$Race=ifelse(Client$Race=="White (HUD)","White",Client$Race)
Client$Race=ifelse(Client$Race=="Asian (HUD)","Asian",Client$Race)
Client$Race=ifelse(Client$Race=="Black or African American (HUD)","African",Client$Race)
Client$Race=ifelse(Client$Race=="American Indian or Alaska Native (HUD)","Indian",Client$Race)
Client$Race=ifelse(Client$Race=="Native Hawaiian or Other Pacific Islander (HUD)","Hawaiian",Client$Race)
Client$Ethnicity=ifelse(Client$Ethnicity=="Hispanic/Latino (HUD)","Latino","Non-Latino")
Disability$Disability=ifelse(Disability$Disability=="Yes (HUD)",1,0)
library(tidyverse)
setwd("/Users/jianchen/Documents/GitHub/bios611-projects-fall-2019-Poutine1025/project_3/scripts/")
# Import data
Income=read_csv("Income.csv")
Disability=read_csv("Disability.csv")
Client=read_csv("Client.csv")
# Redefine the values of variable
Client$Gender=ifelse(Client$Gender=="Trans Female (MTF or Male to Female)","TransF",Client$Gender)
Client$Race=ifelse(Client$Race=="White (HUD)","White",Client$Race)
Client$Race=ifelse(Client$Race=="Asian (HUD)","Asian",Client$Race)
Client$Race=ifelse(Client$Race=="Black or African American (HUD)","African",Client$Race)
Client$Race=ifelse(Client$Race=="American Indian or Alaska Native (HUD)","Indian",Client$Race)
Client$Race=ifelse(Client$Race=="Native Hawaiian or Other Pacific Islander (HUD)","Hawaiian",Client$Race)
Client$Ethnicity=ifelse(Client$Ethnicity=="Hispanic/Latino (HUD)","Latino","Non-Latino")
Disability$Disability=ifelse(Disability$Disability=="Yes (HUD)",1,0)
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender)) +
labs(title = "Sample sizes of different races") +
theme_linedraw()
#Ethinity
ggplot(data = Client, aes(x=Ethnicity)) +
geom_bar(aes(fill=Gender)) +
labs(title = "Sample sizes of different Ethnicities") +
theme_linedraw()
#Age vs Gender filled by Race
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race)) +
labs(title="Age vs Gender filled by Race") +
theme_light()
#Age vs Gender filled by Ethnicity
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Ethnicity)) +
labs(title="Age vs Gender filled by Ethnicity") +
theme_light()
#logistic regression
Disability$Disability=ifelse(Disability$Disability=="Yes (HUD)",1,0)
logistic_model=glm(Disability~Gender+Race+Ethnicity+Age,
data = Disability,
family = binomial(link = "logit"))
summary(logistic_model)
library(tidyverse)
setwd("/Users/jianchen/Documents/GitHub/bios611-projects-fall-2019-Poutine1025/project_3/scripts/")
# Import data
Income=read_csv("Income.csv")
Disability=read_csv("Disability.csv")
Client=read_csv("Client.csv")
# Redefine the values of variable
Client$Gender=ifelse(Client$Gender=="Trans Female (MTF or Male to Female)","TransF",Client$Gender)
Client$Race=ifelse(Client$Race=="White (HUD)","White",Client$Race)
Client$Race=ifelse(Client$Race=="Asian (HUD)","Asian",Client$Race)
Client$Race=ifelse(Client$Race=="Black or African American (HUD)","African",Client$Race)
Client$Race=ifelse(Client$Race=="American Indian or Alaska Native (HUD)","Indian",Client$Race)
Client$Race=ifelse(Client$Race=="Native Hawaiian or Other Pacific Islander (HUD)","Hawaiian",Client$Race)
Client$Ethnicity=ifelse(Client$Ethnicity=="Hispanic/Latino (HUD)","Latino","Non-Latino")
Disability$Disability=ifelse(Disability$Disability=="Yes (HUD)",1,0)
#logistic regression
logistic_model=glm(Disability~Gender+Race+Ethnicity+Age,
data = Disability,
family = binomial(link = "logit"))
summary(logistic_model)
#Income
ggplot(data = Income, aes(x=Income)) +
geom_histogram() +
theme_light()
invgaussain_model=glm(Income~Gender+Race+Ethnicity+Age,
data = Income,
family = inverse.gaussian(link = "1/mu^2"))
summary(invgaussain_model)
#Age vs Gender filled by Race
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race)) +
labs(title="Age vs Gender filled by Race") +
theme_light()
ggsave(path = "../results/Age_vs_Gender_filled_by_Race")
ggsave(filename = "Age_vs_Gender_filled_by_Race",path = "../results")
#Age vs Gender filled by Race
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Race)) +
labs(title="Age vs Gender filled by Race") +
theme_light()
ggsave(filename = "Age_vs_Gender_filled_by_Race",path = "../results")
ggsave(filename = "Age_vs_Gender_filled_by_Race.png",path = "../results")
#Age vs Gender filled by Ethnicity
ggplot(data = Client, aes(x=Gender, y=Age)) +
geom_boxplot(aes(fill=Ethnicity)) +
labs(title="Age vs Gender filled by Ethnicity") +
theme_light()
ggsave(filename = "Age_vs_Gender_filled_by_Ethnicity.png",path = "../results")
#Race
ggplot(data = Client, aes(x=Race)) +
geom_bar(aes(fill=Gender)) +
labs(title = "Sample sizes of different races") +
theme_linedraw()
ggsave(filename = "Sample_sizes_of_different_races.png",path = "../results")
#Ethinity
ggplot(data = Client, aes(x=Ethnicity)) +
geom_bar(aes(fill=Gender)) +
labs(title = "Sample sizes of different ethnicities") +
theme_linedraw()
ggsave(filename = "Sample_sizes_of_different_ethnicities.png",path = "../results")
install.packages('reticulate', repo="http://cran.us.r-project.org")
#creat Rmarkdown file
rmarkdown::render("./results/project3_report.Rmd", "html_document")
library(reticulate)
#creat Rmarkdown file
rmarkdown::render("./results/project3_report.Rmd", "html_document")
#creat Rmarkdown file
rmarkdown::render("../results/project3_report.Rmd", "html_document")
N_O=176
N_A=182
N_B=60
N_AB=17
p=1/3
q=1/3
r=1/3
k=0
N_O=176
N_A=182
N_B=60
N_AB=17
p=1/3
q=1/3
r=1/3
k=0
eps=1
M=2*(N_O+N_A+N_B+N_AB)
result=NULL
N_O=176
N_A=182
N_B=60
N_AB=17
p=1/3
q=1/3
r=1/3
k=0
eps=1
M=2*(N_O+N_A+N_B+N_AB)
result=NULL
while (eps>1e-4) {
p_new=(N_A*(2*p+2*r)/(p+2*r)+N_AB)/M
q_new=(N_B*(2*q+2*r)/(q+2*r)+N_AB)/M
r_new=1-p_new-q_new
eps=max(abs(p-p_new),abs(q-q_new),abs(r-r_new))
result=rbind(result, c(p,q,r,eps))
k=k+1
p=p_new
q=q_new
r=r_new
}
result
N_O=176
N_A=182
N_B=60
N_AB=17
theta=c(1/3,1/3,1/3)
k=0
eps=1
M=2*(N_O+N_A+N_B+N_AB)
result=NULL
while (eps>1e-4) {
theta_new[1]=(N_A*(2*theta[1]+2*theta[3])/(theta[1]+2*theta[3])+N_AB)/M
theta_new[2]=(N_B*(2*theta[2]+2*theta[3])/(theta[2]+2*theta[3])+N_AB)/M
theta_new[3]=1-theta_new[1]-theta_new[2]
eps=max(abs(theta_new-theta))
result=rbind(result, c(theta,eps))
k=k+1
theta=theta_new
}
theta_new-theta
k=0
eps=1
M=2*(N_O+N_A+N_B+N_AB)
result=NULL
while (eps>1e-4) {
theta_new[1]=(N_A*(2*theta[1]+2*theta[3])/(theta[1]+2*theta[3])+N_AB)/M
theta_new[2]=(N_B*(2*theta[2]+2*theta[3])/(theta[2]+2*theta[3])+N_AB)/M
theta_new[3]=1-theta_new[1]-theta_new[2]
eps=max(abs(theta_new-theta))
result=rbind(result, c(theta,eps))
k=k+1
theta=theta_new
}
theta_new=theta
k=0
eps=1
M=2*(N_O+N_A+N_B+N_AB)
result=NULL
while (eps>1e-4) {
theta_new[1]=(N_A*(2*theta[1]+2*theta[3])/(theta[1]+2*theta[3])+N_AB)/M
theta_new[2]=(N_B*(2*theta[2]+2*theta[3])/(theta[2]+2*theta[3])+N_AB)/M
theta_new[3]=1-theta_new[1]-theta_new[2]
eps=max(abs(theta_new-theta))
result=rbind(result, c(theta,eps))
k=k+1
theta=theta_new
}
result
library(tidyverse)
Income=read_csv("./scripts/Income.csv")
